## 前言

我们采集的时候经常会出现乱码现象

一般情况下都是中文显示乱码，英文显示正常

中文字符一直是各位初学者首先要解决的问题

乱码的原因有多种，需要一一分析解决

根本原因是由于编码和解码不一致导致的

现在大部分网站使用的编码有utf-8、gbk、gb2312、iso-8859-1

为避免乱码我们在项目中一定要统一一种编码格式

建议使用utf-8

国标码只是我们国内自己定义的编码

utf-8是万国码，专门设计用来网络传输的，相对来讲比国标码还是传输快，占用资源少

采集的时候我们也需要对编码进行统一

各个网站的编码不是相同的，我们需要把这些网站的内容统一成一种编码在存储起来

我们这里用utf-8作为解码标准

## 如何确定网站的编码呢？

一般可以从以下几个地方找到网站编码

respons响应头里面的

Content-Type:"text/css;charset=UTF-8"

meta 标签

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />

在获取源网页编码时，依次判断下这两个地方即可

理论上这样做是对的，但国内一些网站确是很不符合规范，比如写的gbk，实际是utf-8，有的是写的utf-8，但实际是gbk，当然这是很少的一批网站，但确实存在。

还有的网站编码写的gbk2312 这种错误的

所以在确定网页编码时，应该对该特殊情况做特别处理，如中文检查、默认编码等策略。

## 处理乱码的一般步骤

一般我们采集的时候先读取URL 获取respons响应头里的Content-Type 如果指定了编码

我们就用这个编码来解码就可以了

如果没有指定，我们默认先用utf8解码传输回来的流，获取meta 标签里的  charset  

如果charset还是utf8的,我们 直接进行下一步操作就行

如果是别的编码gbk或gb2312则用新编码进行解码

这样大部分的网页都可以解决

不过还有部分网页的编码 没有给或者是错误的“gbk2312”

这种我们特殊对待一下，如果显示是“gbk2312” 我们默认给“gbk”就行

如果是没有给出的，我们已经默认utf8解析了，如果显示正常则进行下一步操作

如果中文显示的是"???" 或者是"�"

我们就把编码指定为gbk 